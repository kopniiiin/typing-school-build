{"version":3,"sources":["script.js","../modules/simulator/simulator.js","../modules/speedometer/speedometer.js","../modules/accuracy-meter/accuracyMeter.js","../modules/text-char/textChar.js","../modules/text-line/textLine.js","../modules/text-box/textBox.js","../modules/hint-line/hintLine.js","../modules/keyboard/keyboard.js","../modules/hint-dialog/hintDialog.js","../modules/pause-dialog/pauseDialog.js","../modules/keyboard-select-dialog/keyboardSelectDialog.js","../modules/button/button.js","../modules/toggle/toggle.js","../modules/statistics/statistics.js"],"names":[],"mappings":"AAAA;AACA;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AdxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"script.min.js","sourcesContent":["'use strict';\n\n//=require ../modules/simulator/simulator.js\n//=require ../modules/speedometer/speedometer.js\n//=require ../modules/accuracy-meter/accuracyMeter.js\n//=require ../modules/text-char/textChar.js\n//=require ../modules/text-line/textLine.js\n//=require ../modules/text-box/textBox.js\n//=require ../modules/hint-line/hintLine.js\n//=require ../modules/keyboard/keyboard.js\n//=require ../modules/hint-dialog/hintDialog.js\n//=require ../modules/pause-dialog/pauseDialog.js\n//=require ../modules/keyboard-select-dialog/keyboardSelectDialog.js\n//=require ../modules/button/button.js\n//=require ../modules/toggle/toggle.js\n//=require ../modules/statistics/statistics.js\n\nconst simulator = new Simulator({\n  hintDialogMessage: 'Добро пожаловать в тренажер слепой печати!',\n  textBoxTexts: [\n    'Добро пожаловать в тренажер слепой печати!',\n    'Тренируйся каждый день по 15 минут',\n    'И совсем скоро ты будешь печатать, обгоняя мысли'\n  ],\n  keyboardType: '',\n  areHandsOn: true,\n  isKeyboardOn: true,\n  problemKeyCodes: []\n});\n","const ELEMENT_SELECTOR = '.simulator';\nconst METERS_SELECTOR = '.simulator__meters';\nconst CHAR_CONTAINER_SELECTOR = '.simulator__char-container';\nconst PAUSE_BUTTON_SELECTOR = '.simulator__pause-button';\nconst HIDDEN_METERS_CLASS = 'simulator__meters_hidden';\nconst SIMULATOR_WITHOUT_KEYBOARD_CLASS = 'simulator_no-keyboard';\nconst START_MESSAGE = 'Располагай руки на начальной позиции и жми пробел, чтобы начать';\nconst START_KEY = ' ';\nconst REQUIRED_CHARS = /^[а-яА-ЯёЁ0-9 .,:;!?()\"_\\-+=%№]$/;\nconst SHIFT_KEY = 'Shift';\nconst LEFT_SHIFT_CODE = 'ShiftLeft';\nconst BACKSPACE_KEY = 'Backspace';\nconst YO_CHAR = 'ё';\nconst E_CHAR = 'е';\nconst FOREIGN_CHARS = /^[a-zA-Z]$/;\nconst FOREIGN_KEYBOARD_MESSAGE = 'Выбери русскую раскладку';\nconst KEYBOARD_WITHOUT_YO_MESSAGE = 'Выбери раскладку с клавишей Ё';\nconst TIME_TO_SWITCH_BOXES = 440;\nconst CHAR_CONTAINER_SWITCH_CLASS = 'simulator__char-container_switch';\n\nclass Simulator {\n  constructor (parameters) {\n    this._element = document.querySelector(ELEMENT_SELECTOR);\n    this._meters = this._element.querySelector(METERS_SELECTOR);\n    this._charContainer = this._element.querySelector(CHAR_CONTAINER_SELECTOR);\n\n    this._pauseButton = this._element.querySelector(PAUSE_BUTTON_SELECTOR);\n    this._pauseButton.addEventListener('click', this._pauseButtonClickHandler);\n\n    this._isTypoOccured = false;\n\n    this._isForeignKeyboardSelected = false;\n    this._isYoOnKeyboardWithoutYoTyped = false;\n\n    this._isStarted = false;\n    this._isPaused = false;\n    this._pauseDuaration = 0;\n\n    this._pressedKeys = new Set();\n\n    this._accuracyMeter = new AccuracyMeter();\n    this._speedometer = new Speedometer();\n\n    this._textBox = new TextBox(parameters.textBoxTexts);\n    this._charContainer.appendChild(this._textBox.element);\n\n    this._hintLine = new HintLine();\n    this._hintDialog = new HintDialog();\n\n    this._keyboard = new Keyboard(parameters.keyboardType, parameters.areHandsOn);\n    this._keyboardSelectDialog = new KeyboardSelectDialog(this._keyboard);\n\n    if (!parameters.isKeyboardOn) {\n      this.toggleKeyboard();\n    }\n\n    this._pauseDialog = new PauseDialog(\n      this,\n      this._keyboard,\n      this._keyboardSelectDialog,\n    );\n\n    this._statistics = new Statistics(parameters.problemKeyCodes);\n\n    this._setupKeyboard()\n      .then(() => this._showHintDialogMessage(parameters.hintDialogMessage))\n      .then(() => {\n        this._hintLine.showHintMessage(START_MESSAGE);\n        this._keyboard.showHowToType(START_KEY);\n        return this._waitForUserStartKeyKeyup();\n      })\n      .then(() => {\n        this._hintLine.hideMessage();\n        this._start();\n      });\n  }\n\n  toggleKeyboard () {\n    this._element.classList.toggle(SIMULATOR_WITHOUT_KEYBOARD_CLASS);\n  }\n\n  get isKeyboardOn () {\n    return !this._element.classList.contains(SIMULATOR_WITHOUT_KEYBOARD_CLASS);\n  }\n\n  async _setupKeyboard () {\n    if (this._keyboard.type) return;\n\n    return this._keyboardSelectDialog.open(true);\n  }\n\n  async _showHintDialogMessage (hintDialogMessage) {\n    if (!hintDialogMessage) return;\n\n    return this._hintDialog.showHintMessage(hintDialogMessage);\n  }\n\n  _start () {\n    this._isStarted = true;\n    this._startTime = Date.now();\n\n    document.addEventListener('keydown', this._keydownHandler);\n    window.addEventListener('keyup', this._keyupHandler);\n\n    if (this._isTimeToTypeKeys) {\n      this._startWithKeys();\n    } else {\n      this._startWithText();\n    }\n  }\n\n  _waitForUserStartKeyKeyup () {\n    return new Promise((resolve) => {\n      const startKeyKeyupHandler = (evt) => {\n        // Во время паузы нажатия стартовой клавиши не учитываются\n        if (\n          evt.key !== START_KEY ||\n          this._isPaused\n        ) return;\n\n        document.removeEventListener('keyup', startKeyKeyupHandler);\n        resolve();\n      };\n\n      document.addEventListener('keyup', startKeyKeyupHandler);\n    });\n  }\n\n  _startWithKeys () {\n    this._keyBox.showCursor();\n    this._keyboard.showHowToType(this._keyBox.requiredChar);\n  }\n\n  _startWithText () {\n    this._meters.classList.remove(HIDDEN_METERS_CLASS);\n    this._textBox.showCursor();\n    this._keyboard.showHowToType(this._textBox.requiredChar);\n    this._speedometer.start();\n  }\n\n  _pause() {\n    this._isPaused = true;\n\n    document.removeEventListener('keydown', this._keydownHandler);\n\n    // До старта урока после паузы ничего дополнительного делать не нужно\n    if (!this._isStarted) {\n      this._pauseDialog.open()\n        .then(() => this._isPaused = false);\n\n      return;\n    }\n\n    this._pauseTime = Date.now();\n\n    if (!this._isTimeToTypeKeys) {\n      this._speedometer.pause();\n    }\n\n    this._pauseDialog.open()\n      .then(() => {\n        this._isPaused = false;\n        this._hintLine.showHintMessage(START_MESSAGE);\n        return this._waitForUserStartKeyKeyup();\n      }).then(() => {\n        this._hintLine.hideMessage();\n        this._continue();\n      });\n  }\n\n  _continue () {\n    this._pauseDuaration += Date.now() - this._pauseTime;\n\n    document.addEventListener('keydown', this._keydownHandler);\n\n    if (!this._isTimeToTypeKeys) {\n      this._speedometer.continue();\n    }\n  }\n\n  _pauseButtonClickHandler = () => {\n    this._pause();\n  };\n\n  _keydownHandler = (evt) => {\n    if (\n      evt.ctrlKey || evt.altKey || evt.metaKey ||\n      this._pressedKeys.has(evt.code)\n    ) return;\n\n    const key = evt.key;\n\n    if (FOREIGN_CHARS.test(key)) {\n      this._hintLine.showWarningMessage(FOREIGN_KEYBOARD_MESSAGE);\n      this._isForeignKeyboardSelected = true;\n      return;\n    }\n\n    if (this._isForeignKeyboardSelected) {\n      this._hintLine.hideMessage();\n      this._isForeignKeyboardSelected = false;\n    }\n\n    if (!this._keyboard.hasYo && key.toLowerCase() === YO_CHAR) {\n      this._hintLine.showWarningMessage(KEYBOARD_WITHOUT_YO_MESSAGE);\n      this._isYoOnKeyboardWithoutYoTyped = true;\n      return;\n    }\n\n    if (this._isYoOnKeyboardWithoutYoTyped) {\n      this._hintLine.hideMessage();\n      this._isYoOnKeyboardWithoutYoTyped = false;\n    }\n\n    this._pressedKeys.add(evt.code);\n\n    if (REQUIRED_CHARS.test(key)) {\n      this._handleCharKeyKeydown(evt);\n      return;\n    }\n\n    if (key === SHIFT_KEY) {\n      this._handleShiftKeyKeydown(evt);\n      return;\n    }\n\n    if (key === BACKSPACE_KEY) {\n      this._handleBackspaceKeyKeydown();\n    }\n  };\n\n  _handleCharKeyKeydown (evt) {\n    const typedChar = evt.key;\n\n    this._keyboard.pressCharKey(typedChar);\n\n    if (this._isTypoOccured) return;\n\n    if (this._isTimeToTypeKeys) {\n      this._handleKeyTyping(typedChar);\n    } else {\n      this._handleTextTyping(evt);\n    }\n  }\n\n  _handleShiftKeyKeydown(evt) {\n    this._keyboard.pressShiftKey(evt.code === LEFT_SHIFT_CODE);\n  }\n\n  _handleBackspaceKeyKeydown() {\n    this._keyboard.pressBackspaceKey();\n\n    if (!this._isTypoOccured) return;\n\n    if (this._isTimeToTypeKeys) {\n      this._handleKeyErasing();\n    } else {\n      this._handleTextErasing();\n    }\n  }\n\n  _handleKeyTyping(typedChar) {\n    typedChar = this._transformTypedCharIfNeeded(typedChar, this._keyBox.requiredChar);\n\n    if (!this._keyBox.type(typedChar)) {\n      this._isTypoOccured = true;\n      this._keyboard.showHowToErase();\n      return;\n    }\n\n    if (this._keyBox.isFull) {\n      this._switchBoxes();\n      return;\n    }\n\n    this._keyboard.showHowToType(this._keyBox.requiredChar);\n  }\n\n  _handleTextTyping(evt) {\n    const typedChar = this._transformTypedCharIfNeeded(evt.key, this._textBox.requiredChar);\n\n    if (!this._textBox.type(typedChar)) {\n      this._isTypoOccured = true;\n      this._accuracyMeter.addTypo();\n      this._keyboard.showHowToErase();\n      this._statistics.addWrongKeyCode(evt.code);\n      return;\n    }\n\n    this._statistics.addCorrectKeyCode(evt.code);\n    this._accuracyMeter.addCorrectChar();\n    this._speedometer.addChar();\n\n    if (this._textBox.isFull) {\n      this._finish();\n      return;\n    }\n\n    if (this._textBox.isTimeToScroll) {\n      this._textBox.scroll();\n    }\n\n    this._keyboard.showHowToType(this._textBox.requiredChar);\n  }\n\n  _transformTypedCharIfNeeded (typedChar, requiredChar) {\n    if (\n      this._keyboard.hasYo || \n      typedChar.toLowerCase() !== E_CHAR ||\n      requiredChar.toLowerCase() !== YO_CHAR\n    ) return typedChar;\n\n    if (typedChar === E_CHAR) return YO_CHAR;\n    if (typedChar === E_CHAR.toUpperCase()) return YO_CHAR.toUpperCase();\n  }\n\n  _handleKeyErasing() {\n    this._isTypoOccured = false;\n\n    this._keyBox.erase();\n\n    this._keyboard.showHowToType(this._keyBox.requiredChar);\n  }\n\n  _handleTextErasing() {\n    this._isTypoOccured = false;\n\n    this._textBox.erase();\n\n    this._keyboard.showHowToType(this._textBox.requiredChar);\n  }\n\n  _keyupHandler = (evt) => {\n    if (evt.ctrlKey || evt.altKey || evt.metaKey) return;\n\n    const { key, code } = evt;\n\n    if (!this._pressedKeys.has(code)) return;\n\n    this._pressedKeys.delete(code);\n\n    if (REQUIRED_CHARS.test(key)) {\n      this._keyboard.releaseCharKey(key);\n      return;\n    }\n\n    if (key === SHIFT_KEY) {\n      this._keyboard.releaseShiftKey(code === LEFT_SHIFT_CODE);\n      return;\n    }\n\n    if (key === BACKSPACE_KEY) {\n      this._keyboard.releaseBackspaceKey();\n    }\n  };\n\n  _switchBoxes() {\n    document.removeEventListener('keydown', this._keydownHandler);\n\n    this._isTimeToTypeKeys = false;\n\n    this._keyboard.takeInitialPosition();\n\n    this._charContainer.classList.add(CHAR_CONTAINER_SWITCH_CLASS);\n\n    setTimeout(() => {\n      this._charContainer.replaceChild(this._textBox.element, this._keyBox.element);\n      this._charContainer.classList.remove(CHAR_CONTAINER_SWITCH_CLASS);\n\n      this._startWithText();\n\n      document.addEventListener('keydown', this._keydownHandler);\n    }, TIME_TO_SWITCH_BOXES);\n  }\n\n  _finish () {\n    document.removeEventListener('keydown', this._keydownHandler);\n\n    this._keyboard.takeInitialPosition();\n    this._speedometer.finish();\n\n    const keyCodesToTypoAmounts = {};\n    this._statistics.keyCodesToTypoAmounts.forEach((typoAmount, keyCode) => {\n      keyCodesToTypoAmounts[keyCode] = typoAmount;\n    });\n\n    const keyCodesToCorrectSeriesAmounts = {};\n    this._statistics.keyCodesToCorrectSeriesAmounts.forEach((correctSeriesAmount, keyCode) => {\n      keyCodesToCorrectSeriesAmounts[keyCode] = correctSeriesAmount;\n    });\n\n    const lessonResults = {\n      lessonDuration: Date.now() - this._startTime - this._pauseDuaration,\n      lessonLength: this._keyBox ?\n          this._keyBox.length + this._textBox.length : this._textBox.length,\n      averageSpeed: this._speedometer.averageSpeed,\n      keyCodesToTypoAmounts: keyCodesToTypoAmounts,\n      keyCodesToCorrectSeriesAmounts: keyCodesToCorrectSeriesAmounts\n    };\n  }\n}\n","const TIME_BETWEEN_CALCULATIONS = 1000;\nconst SECONDS_PER_PERIOD_LIMIT = 10;\nconst SECONDS_PER_MINUTE = 60;\nconst MILLISECONDS_PER_MINUTE = 60000;\n\nclass Speedometer {\n  constructor() {\n    this._element = document.querySelector('.speedometer');\n    this._indicator = this._element.querySelector('.speedometer__indicator');\n\n    this._charCounters = [];\n    this._currentCharCounter = 0;\n    this._currentSpeed = 0;\n\n    // Для правильного продолжения работы после паузы состояние сохраняется\n    // после каждого нажатия и в начале работы\n    this._saveCurrentState();\n\n    this._totalCharCounter = 0;\n\n    this._pauseDuration = 0;\n  }\n\n  start() {\n    this._startTime = Date.now();\n    \n    this._calculationInterval = setInterval(\n      this._speedCalculator, \n      TIME_BETWEEN_CALCULATIONS\n    );\n  }\n\n  pause() {\n    clearInterval(this._calculationInterval);\n    \n    this._pauseTime = Date.now();\n  }\n\n  continue() {\n    this._restoreCurrentState();\n\n    this._pauseDuration += Date.now() - this._pauseTime;\n    \n    this._calculationInterval = setInterval(\n      this._speedCalculator, \n      TIME_BETWEEN_CALCULATIONS\n    );\n  }\n\n  finish() {\n    clearInterval(this._calculationInterval);\n    \n    this._calculateAverageSpeed();\n  }\n\n  addChar() {\n    this._totalCharCounter++;\n    this._currentCharCounter++;\n\n    this._saveCurrentState();\n  }\n\n  get averageSpeed () {\n    return this._averageSpeed;\n  }\n\n  _speedCalculator = () => {\n    this._charCounters.push(this._currentCharCounter);\n    this._currentCharCounter = 0;\n\n    const charsPerPeriod = this._charCounters.reduce((charsPerPeriod, charsPerSecond) =>\n      charsPerPeriod + charsPerSecond\n    );\n\n    const secondsPerPeriod = this._charCounters.length;\n\n    // Скорость измеряется в сим/мин\n    this._currentSpeed = Math.round(\n      charsPerPeriod * (SECONDS_PER_MINUTE / secondsPerPeriod)\n    );\n\n    this._updateIndicator();\n\n    if (secondsPerPeriod === SECONDS_PER_PERIOD_LIMIT) {\n      this._charCounters.shift();\n    }\n  };\n\n  _calculateAverageSpeed() {\n    const totalTimeInMilliseconds = Date.now() - this._startTime - this._pauseDuration;\n    const totalTimeInMinutes = totalTimeInMilliseconds / MILLISECONDS_PER_MINUTE;\n\n    // Скорость измеряется в сим/мин\n    this._averageSpeed = Math.round(\n      this._totalCharCounter / totalTimeInMinutes\n    );\n  }\n\n  _updateIndicator() {\n    this._indicator.textContent = this._currentSpeed;\n  }\n\n  _saveCurrentState() {\n    this._lastCharCounters = this._charCounters.slice();\n    this._lastCharCounter = this._currentCharCounter;\n    this._lastSpeed = this._currentSpeed;\n  }\n\n  _restoreCurrentState() {\n    this._charCounters = this._lastCharCounters.slice();\n    this._currentCharCounter = this._lastCharCounter;\n    this._currentSpeed = this._lastSpeed;\n\n    this._updateIndicator();\n  }\n}\n","class AccuracyMeter {\n  constructor() {\n    this._element = document.querySelector('.accuracy-meter');\n    this._indicator = this._element.querySelector('.accuracy-meter__indicator');\n\n    this._totalCharCounter = 0;\n    this._correctCharCounter = 0;\n  }\n\n  addCorrectChar() {\n    this._totalCharCounter++;\n    this._correctCharCounter++;\n    this._calculateAccuracy();\n    this._updateIndicator();\n  }\n\n  addTypo() {\n    this._totalCharCounter++;\n    this._calculateAccuracy();\n    this._updateIndicator();\n  }\n\n  get accuracy() {\n    return this._accuracy;\n  }\n\n  _calculateAccuracy() {\n    this._accuracy = Math.round((this._correctCharCounter / this._totalCharCounter) * 100);\n  }\n\n  _updateIndicator() {\n    this._indicator.textContent = this._accuracy + '%';\n  }\n}\n","class TextChar {\n  constructor (requiredChar) {\n    this._element = TextChar.template.cloneNode(true);\n    \n    this._requiredChar = requiredChar;\n\n    this._element.textContent = this._requiredChar;\n  }\n\n  type (typedChar) {\n    this._typedChar = typedChar;\n    \n    const isTypedCharCorrect = this._typedChar === this._requiredChar;\n\n    if (isTypedCharCorrect) {\n      this._element.classList.add('text-char_correct');\n    } else {\n      this._element.classList.add('text-char_typo');\n      this._element.textContent = this._typedChar;\n    }\n\n    this.hideCursor();\n\n    return isTypedCharCorrect;\n  }\n\n  erase () {\n    const isTypoErased = this._typedChar !== this._requiredChar;\n\n    this._element.classList.remove('text-char_correct', 'text-char_typo');\n    this._element.textContent = this._requiredChar;\n\n    this._typedChar = null;\n\n    this.showCursor();\n\n    return isTypoErased;\n  }\n\n  showCursor () {\n    this._element.classList.add('text-char_cursor');\n  }\n\n  hideCursor () {\n    this._element.classList.remove('text-char_cursor');\n  }\n\n  get element () {\n    return this._element;\n  }\n\n  get requiredChar () {\n    return this._requiredChar;\n  }\n\n  get isFull () {\n    return Boolean(this._typedChar)\n  }\n}\n\nTextChar.template = document.querySelector('#template-text-char')\n  .content.querySelector('.text-char');\n","class TextLine {\n  constructor(text) {\n    this._element = TextLine.template.cloneNode(true);\n\n    this._chars = [];\n\n    text.split('').forEach(char => {\n      const newChar = new TextChar(char);\n\n      this._chars.push(newChar);\n      \n      this._element.appendChild(newChar.element);\n    });\n\n    this._currentCharIndex = 0;\n    this._currentChar = this._chars[this._currentCharIndex];\n  }\n\n  type (typedChar) {\n    const isTypedCharCorrect = this._currentChar.type(typedChar);\n\n    if (!this.isFull) {\n      this._moveCurrentCharForward();\n    }\n\n    return isTypedCharCorrect;\n  }\n\n  erase () {\n    // Если строка полная, то стирается последний символ\n    if (!this.isFull) {\n      this._moveCurrentCharBackward();\n    }\n\n    return this._currentChar.erase();\n  }\n\n  showCursor () {\n    this._currentChar.showCursor();\n  }\n\n  hideCursor () {\n    this._currentChar.hideCursor();\n  }\n\n  get element () {\n    return this._element;\n  }\n\n  get requiredChar () {\n    return this._currentChar.requiredChar;\n  }\n\n  get isEmpty () {\n    return !this._currentChar.isFull &&\n      this._currentCharIndex === 0;\n  }\n\n  get isFull () {\n    return this._currentChar.isFull &&\n      this._currentCharIndex === this._chars.length - 1;\n  }\n\n  get length () {\n    return this._chars.length;\n  }\n\n  _moveCurrentCharForward () {\n    this._currentCharIndex++;\n    this._currentChar = this._chars[this._currentCharIndex];\n    this._currentChar.showCursor();\n  }\n\n  _moveCurrentCharBackward () {\n    this._currentChar.hideCursor();\n    this._currentCharIndex--;\n    this._currentChar = this._chars[this._currentCharIndex];\n  }\n}\n\nTextLine.template = document.querySelector('#template-text-line')\n  .content.querySelector('.text-line');\n","class TextBox {  \n  constructor (texts) {\n    this._element = TextBox.template.cloneNode(true);\n    \n    this._lines = [];\n    \n    texts.forEach(text => {\n      const newLine = new TextLine(text);\n      \n      this._lines.push(newLine);\n      \n      newLine.element.classList.add('text-box__text-line');\n      this._element.appendChild(newLine.element);\n    });\n\n    this._currentLineIndex = 0;\n    this._currentLine = this._lines[this._currentLineIndex];\n\n    this._scrollHeight = 0;\n  }\n\n  type (typedChar) {\n    const isTypedCharCorrect = this._currentLine.type(typedChar);\n\n    if (!this.isFull && this._currentLine.isFull) {\n        this._moveCurrentLineForward();\n    }\n\n    return isTypedCharCorrect;\n  }\n\n  erase () {\n    if (this._currentLine.isEmpty) {\n      this._moveCurrentLineBackward();\n    }\n\n    return this._currentLine.erase();\n  }\n\n  showCursor () {\n    this._currentLine.showCursor();\n  }\n\n  hideCursor () {\n    this._currentLine.hideCursor();\n  }\n\n  scroll () {\n    this._scrollHeight++;\n\n    this._lines.forEach(line => {\n      line.element.style.transform = `translateY(${this._scrollHeight * -100}%)`;\n    });\n  }\n\n  get element () {\n    return this._element;\n  }\n\n  get requiredChar () {\n    return this._currentLine.requiredChar;\n  }\n\n  get isEmpty () {\n    return this._currentLineIndex === 0 &&\n        this._currentLine.isEmpty;\n  }\n\n  get isFull () {\n    return this._currentLineIndex === this._lines.length - 1 &&\n        this._currentLine.isFull;\n  }\n\n  get isTimeToScroll () {\n    return this._currentLine.isEmpty &&\n      this._currentLineIndex > 1 &&\n      this._currentLineIndex < this._lines.length - 1;\n  }\n\n  get length () {\n    return this._lines.reduce((boxLength, lineLength) => {\n      return boxLength + lineLength.length;\n    }, 0);\n  }\n\n  _moveCurrentLineForward () {\n    this._currentLineIndex++;\n    this._currentLine = this._lines[this._currentLineIndex];\n    this._currentLine.showCursor();\n  }\n\n  _moveCurrentLineBackward () {\n    this._currentLine.hideCursor();\n    this._currentLineIndex--;\n    this._currentLine = this._lines[this._currentLineIndex];\n  }\n}\n\nTextBox.template = document.querySelector('#template-text-box')\n  .content.querySelector('.text-box');\n\n","class HintLine {\n  constructor () {\n    this._element = document.querySelector('.hint-line');\n  }\n\n  showHintMessage (hintMessage) {\n    this._element.textContent = hintMessage;\n    this._element.classList.remove('hint-line_hidden', 'hint-line_warning');\n  }\n\n  showWarningMessage (warningMessage) {\n    this._element.textContent = warningMessage;\n    this._element.classList.add('hint-line_warning')\n    this._element.classList.remove('hint-line_hidden');\n  }\n\n  hideMessage () {\n    this._element.classList.add('hint-line_hidden');\n  }\n}\n","const DEFAULT_KEYBOARD_TYPE = 'keyboard-windows-ansi-rus-pc';\n\nconst KEYBOARD_TYPE_WITHOUT_YO = 'keyboard-macos-ansi-rus-pc';\n\nconst HAND_INITIAL_POSITION = 1;\n\nconst LEFT_HAND_POSITIONS_TO_OFFSETS = [\n  {x: 0, y: 0},\n  {x: -15, y: -22},\n  {x: -18, y: -22},\n  {x: -18, y: -21},\n  {x: -20, y: -21},\n  {x: -21, y: -23},\n  {x: -21, y: -21},\n  {x: -21, y: -20},\n  {x: -1, y: -9},\n  {x: -1, y: -11},\n  {x: -1, y: -12},\n  {x: -3, y: -11},\n  {x: 0, y: -10},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: -8, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: -2, y: -2},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0}\n];\n\nconst RIGHT_HAND_POSITIONS_TO_OFFSETS = [\n  {x: 0, y: 0},\n  {x: 4, y: -22},\n  {x: 1, y: -21},\n  {x: 2, y: -23},\n  {x: 2, y: -22},\n  {x: 2, y: -24},\n  {x: 3, y: -25},\n  {x: 4, y: -20},\n  {x: 4, y: -8},\n  {x: 1, y: -9},\n  {x: 0, y: -10},\n  {x: 0, y: -9},\n  {x: 0, y: -10},\n  {x: 1, y: -12},\n  {x: 0, y: -11},\n  {x: -4, y: -9},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 1, y: 0},\n  {x: 0, y: 0},\n  {x: 1, y: -5},\n  {x: 0, y: 0},\n  {x: 0, y: 0},\n  {x: 0, y: 1},\n  {x: 0, y: 0},\n];\n\nclass Keyboard {\n  constructor (keyboardType, areHandsOn) {\n    this._element = document.querySelector('.keyboard');\n    this._keys = this._element.querySelector('.keyboard__keys');\n    this._leftHand = this._element.querySelector('.keyboard__hand_left');\n    this._rightHand = this._element.querySelector('.keyboard__hand_right');\n\n    this._isHandToPressSpaceKeyLeft = true;\n    this._isTimeToPressBackspace = false;\n\n    this._keyboardType = keyboardType;\n\n    if (!this._keyboardType) return;\n\n    if (this._keyboardType !== DEFAULT_KEYBOARD_TYPE) {\n      this._replaceKeys();\n    }\n\n    this._rememberHowToPressKeys();\n\n    if (!areHandsOn) {\n      this.toggleHands();\n    }\n  }\n\n  showHowToType (requiredChar) {\n    this._hideCurrentRequiredKeys();\n\n    this._requiredChar = requiredChar;\n\n    requiredChar = this._transformCharIfNeeded(requiredChar);\n\n    const requiredCharKeyPressingInfo = this._charsToPressingInfo.get(requiredChar);\n    \n    this._showRequiredKeys(\n      requiredCharKeyPressingInfo.charKey, \n      requiredCharKeyPressingInfo.shiftKey\n    );\n\n    let leftHandPosition = requiredCharKeyPressingInfo.leftHandPosition;\n    let rightHandPosition = requiredCharKeyPressingInfo.rightHandPosition;\n\n    // После нажатия любой символьной клашивши (отличной от пробела) пробел нажимается рукой,\n    // которая была в начальном положении или нажимала shift.\n    // Пробелы подряд нажимаются одной рукой.\n    if (this._requiredChar === ' ') {\n      leftHandPosition = this._isHandToPressSpaceKeyLeft ? leftHandPosition : HAND_INITIAL_POSITION;\n      rightHandPosition = this._isHandToPressSpaceKeyLeft ? HAND_INITIAL_POSITION : rightHandPosition;\n    } else {\n      this._isHandToPressSpaceKeyLeft =\n        leftHandPosition === HAND_INITIAL_POSITION ||\n        leftHandPosition === this._leftShiftKeyPressingInfo.leftHandPosition;\n    }\n\n    this._showHandPosition(leftHandPosition, rightHandPosition);\n  }\n\n  showHowToErase () {\n    this._hideCurrentRequiredKeys();\n\n    this._isTimeToPressBackspace = true;\n\n    this._showRequiredKeys(this._backspaceKeyPressingInfo.backspaceKey);\n\n    this._showHandPosition(this._backspaceKeyPressingInfo.leftHandPosition, this._backspaceKeyPressingInfo.rightHandPosition);\n  }\n\n  takeInitialPosition () {\n    this._hideCurrentRequiredKeys();\n    this._showHandPosition(HAND_INITIAL_POSITION, HAND_INITIAL_POSITION);\n  }\n\n  pressCharKey (typedChar) {\n    this._showPressedKey(this._charsToPressingInfo.get(typedChar).charKey);\n  }\n\n  releaseCharKey (typedChar) {\n    this._hideReleasedKey(this._charsToPressingInfo.get(typedChar).charKey);\n  }\n\n  pressShiftKey (isLeft) {\n    const pressedShiftKey = isLeft ?\n      this._leftShiftKeyPressingInfo.shiftKey :\n      this._rightShiftKeyPressingInfo.shiftKey;\n\n    this._showPressedKey(pressedShiftKey);\n  }\n\n  releaseShiftKey (isLeft) {\n    const releasedShiftKey = isLeft ?\n      this._leftShiftKeyPressingInfo.shiftKey :\n      this._rightShiftKeyPressingInfo.shiftKey;\n\n    this._hideReleasedKey(releasedShiftKey);\n  }\n\n  pressBackspaceKey () {\n    this._showPressedKey(this._backspaceKeyPressingInfo.backspaceKey);\n  }\n\n  releaseBackspaceKey () {\n    this._hideReleasedKey(this._backspaceKeyPressingInfo.backspaceKey);\n  }\n\n  toggleHands () {\n    this._element.classList.toggle('keyboard_no-hands');\n  }\n\n  changeType (keyboardType) {\n    this._keyboardType = keyboardType;\n\n    this._isHandToPressSpaceKeyLeft = true;\n\n    this._replaceKeys();\n    this._rememberHowToPressKeys();\n\n    if (this._requiredChar) {\n      this.showHowToType(this._requiredChar);\n    } else if (this._isTimeToPressBackspace) {\n      this.showHowToErase();\n    }\n  }\n\n  get type () {\n    return this._keyboardType;\n  }\n\n  get areHandsOn () {\n    return !this._element.classList.contains('keyboard_no-hands');\n  }\n\n  get hasYo () {\n    return this._keyboardType !== KEYBOARD_TYPE_WITHOUT_YO;\n  }\n\n  _showPressedKey (pressedKey) {\n    const pressedKeyClass = (pressedKey.classList.contains('keyboard__key_required')) ?\n      'keyboard__key_correct' :\n      'keyboard__key_wrong';\n\n    pressedKey.classList.add(pressedKeyClass);\n  }\n\n  _hideReleasedKey (releasedKey) {\n    releasedKey.classList.remove('keyboard__key_correct', 'keyboard__key_wrong');\n  }\n\n  _showRequiredKeys (firstRequiredKey, secondRequiredKey) {\n    firstRequiredKey.classList.add('keyboard__key_required');\n\n    if (!secondRequiredKey) return;\n\n    secondRequiredKey.classList.add('keyboard__key_required');\n  }\n\n  _showHandPosition (leftHandPosition, rightHandPosition) {\n    const leftHandOffsetX = LEFT_HAND_POSITIONS_TO_OFFSETS[leftHandPosition - 1].x;\n    const leftHandOffsetY = LEFT_HAND_POSITIONS_TO_OFFSETS[leftHandPosition - 1].y;\n    this._leftHand.innerHTML = `<use xlink:href='#hand-left-${leftHandPosition}'></use>`;\n    this._leftHand.style.transform = `translate(${leftHandOffsetX}%, ${leftHandOffsetY}%)`;\n\n    const rightHandOffsetX = RIGHT_HAND_POSITIONS_TO_OFFSETS[rightHandPosition - 1].x;\n    const rightHandOffsetY = RIGHT_HAND_POSITIONS_TO_OFFSETS[rightHandPosition - 1].y;\n    this._rightHand.innerHTML = `<use xlink:href='#hand-right-${rightHandPosition}'></use>`;\n    this._rightHand.style.transform = `translate(${rightHandOffsetX}%, ${rightHandOffsetY}%)`;\n  }\n\n  _hideCurrentRequiredKeys () {\n    this._leftShiftKeyPressingInfo.shiftKey.classList.remove('keyboard__key_required');\n    this._rightShiftKeyPressingInfo.shiftKey.classList.remove('keyboard__key_required');\n\n    this._isTimeToPressBackspace = false;\n    this._backspaceKeyPressingInfo.backspaceKey.classList.remove('keyboard__key_required');\n\n    if (!this._requiredChar) return;\n\n    const charToFindRequiredCharKey = this._transformCharIfNeeded(this._requiredChar);\n\n    this._charsToPressingInfo.get(charToFindRequiredCharKey).charKey\n      .classList.remove('keyboard__key_required');\n\n    this._requiredChar = null;\n  }\n\n  _transformCharIfNeeded (char) {\n    if (\n      this.hasYo ||\n      char.toLowerCase() !== 'ё'\n    ) return char;\n\n    if (char === 'ё') return 'е';\n    if (char === 'ё'.toUpperCase()) return 'е'.toUpperCase();\n  }\n\n  _replaceKeys () {\n    const newReplaceableKeys = Keyboard.template.getElementById(this._keyboardType).cloneNode(true);\n    const oldReplaceableKeys = this._keys.querySelector('.keyboard__replaceable-keys');\n\n    this._keys.replaceChild(newReplaceableKeys, oldReplaceableKeys);\n  }\n\n  _rememberHowToPressKeys () {\n    this._rememberHowToPressShiftKeys();\n    \n    this._rememberHowToPressBackspaceKey();\n\n    this._charsToPressingInfo = new Map();\n\n    this._element.querySelectorAll('[data-char]').forEach((charKey) => {\n      this._rememberHowToPressCharKey(charKey);\n    });\n  }\n\n  _rememberHowToPressShiftKeys () {\n    const leftShiftKey = this._element.querySelector('[data-shift=\"left\"]');\n    const rightShiftKey = this._element.querySelector('[data-shift=\"right\"]');\n\n    this._leftShiftKeyPressingInfo = {\n      shiftKey: leftShiftKey,\n      leftHandPosition: parseInt(leftShiftKey.dataset.leftHandPosition)\n    };\n\n    this._rightShiftKeyPressingInfo = {\n      shiftKey: rightShiftKey,\n      rightHandPosition: parseInt(rightShiftKey.dataset.rightHandPosition)\n    };\n  }\n\n  _rememberHowToPressBackspaceKey () {\n    const backspaceKey = this._element.querySelector('[data-backspace]');\n\n    // клавиша backspace всегда нажимается правой рукой\n    this._backspaceKeyPressingInfo = {\n      backspaceKey: backspaceKey,\n      leftHandPosition: HAND_INITIAL_POSITION,\n      rightHandPosition: parseInt(backspaceKey.dataset.rightHandPosition)\n    }\n  };\n\n  _rememberHowToPressCharKey (charKey) {\n    const char = charKey.dataset.char;\n    const shiftChar = charKey.dataset.shiftChar;\n    const leftHandPosition = parseInt(charKey.dataset.leftHandPosition) || HAND_INITIAL_POSITION;\n    const rightHandPosition = parseInt(charKey.dataset.rightHandPosition) || HAND_INITIAL_POSITION;\n\n    this._charsToPressingInfo.set(char, {\n      charKey: charKey,\n      leftHandPosition: leftHandPosition,\n      rightHandPosition: rightHandPosition\n    });\n\n    if (!shiftChar) return;\n\n    const isLeftShiftRequired = leftHandPosition === HAND_INITIAL_POSITION;\n\n    this._charsToPressingInfo.set(shiftChar, {\n      charKey: charKey,\n      shiftKey: isLeftShiftRequired ? this._leftShiftKeyPressingInfo.shiftKey : this._rightShiftKeyPressingInfo.shiftKey,\n      leftHandPosition: isLeftShiftRequired ? this._leftShiftKeyPressingInfo.leftHandPosition : leftHandPosition,\n      rightHandPosition: isLeftShiftRequired ? rightHandPosition : this._rightShiftKeyPressingInfo.rightHandPosition\n    });\n  }\n}\n\nKeyboard.template = document.querySelector('#template-keyboard').content;\n","class HintDialog {\n  constructor () {\n    this._element = document.querySelector('.hint-dialog');\n    this._overlay = this._element.querySelector('.hint-dialog__overlay');\n    this._message = this._element.querySelector('.hint-dialog__message');\n    this._closeButton  = this._element.querySelector('.hint-dialog__close-button');\n    \n    this._overlay.addEventListener('click', this._overlayClickHandler);\n    this._closeButton.addEventListener('click', this._closeButtonClickHandler);\n  }\n\n  async showHintMessage (hintMessage) {\n    this._element.classList.remove('hint-dialog_hidden');\n    this._message.textContent = hintMessage;\n    this._closeButton.focus();\n\n    document.addEventListener('keydown', this._keydownHandler);\n\n    return new Promise((resolve => {\n      this._closeDialogPromiseResolver = resolve;\n    }));\n  }\n\n  _close () {\n    this._element.classList.add('hint-dialog_hidden');\n\n    document.removeEventListener('keydown', this._keydownHandler);\n\n    this._closeDialogPromiseResolver();\n  };\n\n  _manageFocus = () => {\n    if (document.activeElement !== this._closeButton) {\n      this._closeButton.focus();\n    }\n  };\n\n  _overlayClickHandler = () => {\n    this._close();\n  };\n  \n  _closeButtonClickHandler = () => {\n    this._close();  \n  };\n  \n  _keydownHandler = (evt) => {\n    if (evt.key === 'Tab') {\n      evt.preventDefault();\n      this._manageFocus();\n    }\n    \n    if (evt.key === 'Escape') {\n      evt.preventDefault();\n      this._close();\n    }\n  };\n}\n","class PauseDialog {  \n  constructor(simulator, keyboard, keyboardSelectDialog) {\n    this._element = document.querySelector('.pause-dialog');\n    this._overlay = this._element.querySelector('.pause-dialog__overlay');\n    this._options = this._element.querySelector('.pause-dialog__options');\n    \n    this._closeButton = this._element.querySelector('.pause-dialog__close-button');\n    this._keyboardButton = this._options.querySelector('.pause-dialog__keyboard-button');\n    this._submitButton = this._options.querySelector('.pause-dialog__submit-button');\n\n    this._keyboardToggle = new Toggle(\n      this._options.querySelector('.pause-dialog__toggle_keyboard')\n    );\n\n    this._handsToggle = new Toggle(\n      this._options.querySelector('.pause-dialog__toggle_hands')\n    );\n\n    this._simulator = simulator;\n\n    this._keyboard = keyboard;\n\n    this._keyboardSelectDialog = keyboardSelectDialog;\n\n    this._overlay.addEventListener('click', this._overlayClickHandler);\n    this._closeButton.addEventListener('click', this._closeButtonClickHandler);\n    this._keyboardButton.addEventListener('click', this._keyboardButtonClickHandler);\n    this._options.addEventListener('click', this._optionsClickHandler);\n    this._options.addEventListener('submit', this._optionsSubmitHandler);\n\n    this._initialOptionVariants = {\n      isKeyboardOn: this._simulator.isKeyboardOn,\n      areHandsOn: this._keyboard.areHandsOn\n    };\n\n    this._setInitialOptionVariants();\n  }\n\n  open () {\n    this._element.classList.remove('pause-dialog_hidden');\n\n    document.addEventListener('keydown', this._keydownHandler);\n\n    this._closeButton.focus();\n    \n    return new Promise((resolve => {\n      this._closeDialogPromiseResolver = resolve;\n    }));\n  }\n  \n  _close = () => {\n    this._element.classList.add('pause-dialog_hidden');\n\n    document.removeEventListener('keydown', this._keydownHandler);\n\n    this._setInitialOptionVariants();\n  \n    this._closeDialogPromiseResolver();\n  };\n\n  _setInitialOptionVariants () {\n    if (this._keyboardToggle.isChecked !== this._initialOptionVariants.isKeyboardOn) {\n      this._keyboardToggle.toggle();\n    }\n\n    if (this._handsToggle.isChecked !== this._initialOptionVariants.areHandsOn) {\n      this._handsToggle.toggle();\n    }\n\n    this._manageAbilityToToggleHands();\n    this._manageAbilityToSubmitOptions();\n  }\n  \n  _submitOptions () {\n    this._initialOptionVariants = {\n      isKeyboardOn: this._keyboardToggle.isChecked,\n      areHandsOn: this._handsToggle.isChecked\n    };\n\n    if (this._initialOptionVariants.isKeyboardOn !== this._simulator.isKeyboardOn) {\n      this._simulator.toggleKeyboard();\n    }\n\n    if (this._initialOptionVariants.areHandsOn !== this._keyboard.areHandsOn) {\n      this._keyboard.toggleHands();\n    }\n\n    this._submitButton.disabled = true;\n  }\n  \n  _manageAbilityToSubmitOptions () {\n    this._submitButton.disabled = \n      this._keyboardToggle.isChecked === this._initialOptionVariants.isKeyboardOn &&\n      this._handsToggle.isChecked === this._initialOptionVariants.areHandsOn;\n  }\n\n  _manageAbilityToToggleHands () {\n    this._handsToggle.disabled = !this._keyboardToggle.isChecked;\n  }\n\n  _manageFocus = (evt) => {\n    let lastFocusableElement = this._submitButton.disabled ?\n        this._keyboardButton : this._submitButton;\n\n    if (evt.shiftKey) {\n      if (document.activeElement === this._closeButton) {\n        evt.preventDefault();\n        lastFocusableElement.focus();\n      }\n    } else if (document.activeElement === lastFocusableElement) {\n      evt.preventDefault();\n      this._closeButton.focus();\n    }\n  };\n\n  async _openKeyboardSelectDialog () {\n    this._element.classList.add('pause-dialog_hidden');\n\n    document.removeEventListener('keydown', this._keydownHandler);\n\n    await this._keyboardSelectDialog.open();\n\n    this._keyboardButton.textContent = this._keyboardSelectDialog.keyboardLayout;\n    this._keyboardButton.focus();\n\n    this._element.classList.remove('pause-dialog_hidden');\n\n    document.addEventListener('keydown', this._keydownHandler);\n  }\n  \n  _optionsClickHandler = (evt) => {\n    if (!evt.target.classList.contains('pause-dialog__toggle')) return;\n\n    this._manageAbilityToToggleHands();\n    this._manageAbilityToSubmitOptions();\n  };\n\n  _optionsSubmitHandler = (evt) => {\n    evt.preventDefault();\n\n    this._submitOptions();\n  };\n\n  _overlayClickHandler = () => {\n    this._close();\n  };\n  \n  _closeButtonClickHandler = () => {\n    this._close();\n  };\n\n  _keyboardButtonClickHandler = () => {\n    this._openKeyboardSelectDialog();\n  };\n\n  _keydownHandler = (evt) => {\n    if (evt.key === 'Tab') {\n      this._manageFocus(evt);\n    }\n\n    if (evt.key === 'Escape') {\n      evt.preventDefault();\n\n      this._close();\n    }\n  };\n}\n","const OS_OPTION = 'os';\nconst OS_WINDOWS = 'windows';\nconst OS_MACOS = 'macos';\n\nconst ENTER_OPTION = 'enter';\nconst ENTER_ANSI = 'ansi';\nconst ENTER_ISO = 'iso';\n\nconst LAYOUT_OPTION = 'layout';\nconst LAYOUT_RUS = 'rus';\nconst LAYOUT_RUS_PC = 'rus-pc';\n\nconst LAYOUTS_NAMES_TRANSLATIONS = new Map ([\n  [LAYOUT_RUS, 'Русская'],\n  [LAYOUT_RUS_PC, 'Русская-ПК']\n]);\n\nconst KEYBOARD_TYPE_WINDOWS_ANSI_RUS_PC = 'keyboard-windows-ansi-rus-pc';\nconst KEYBOARD_TYPE_WINDOWS_ISO_RUS_PC = 'keyboard-windows-iso-rus-pc';\nconst KEYBOARD_TYPE_MACOS_ANSI_RUS = 'keyboard-macos-ansi-rus';\nconst KEYBOARD_TYPE_MACOS_ANSI_RUS_PC = 'keyboard-macos-ansi-rus-pc';\nconst KEYBOARD_TYPE_MACOS_ISO_RUS = 'keyboard-macos-iso-rus';\nconst KEYBOARD_TYPE_MACOS_ISO_RUS_PC = 'keyboard-macos-iso-rus-pc';\n\nconst KEYBOARD_TYPES_TO_OPTION_VARIANTS = new Map ([\n  [KEYBOARD_TYPE_WINDOWS_ANSI_RUS_PC, {\n    os: OS_WINDOWS,\n    enter: ENTER_ANSI\n  }],\n  [KEYBOARD_TYPE_WINDOWS_ISO_RUS_PC, {\n    os: OS_WINDOWS,\n    enter: ENTER_ISO\n  }],\n  [KEYBOARD_TYPE_MACOS_ANSI_RUS, {\n    os: OS_MACOS,\n    enter: ENTER_ANSI,\n    layout: LAYOUT_RUS\n  }],\n  [KEYBOARD_TYPE_MACOS_ANSI_RUS_PC, {\n    os: OS_MACOS,\n    enter: ENTER_ANSI,\n    layout: LAYOUT_RUS_PC\n  }],\n  [KEYBOARD_TYPE_MACOS_ISO_RUS, {\n    os: OS_MACOS,\n    enter: ENTER_ISO,\n    layout: LAYOUT_RUS\n  }],\n  [KEYBOARD_TYPE_MACOS_ISO_RUS_PC, {\n    os: OS_MACOS,\n    enter: ENTER_ISO,\n    layout: LAYOUT_RUS_PC\n  }],\n]);\n\nclass KeyboardSelectDialog {\n  constructor (keyboard) {\n    this._element = document.querySelector('.keyboard-select-dialog');\n    this._overlay = this._element.querySelector('.keyboard-select-dialog__overlay');\n    this._options = this._element.querySelector('.keyboard-select-dialog__options');\n    this._layoutOption = this._options.querySelector('.keyboard-select-dialog__option_layout');\n\n    this._closeButton = this._element.querySelector('.keyboard-select-dialog__close-button');\n    this._submitButton = this._options.querySelector('.keyboard-select-dialog__submit-button');\n\n    this._overlay.addEventListener('click', this._overlayClickHandler);\n    this._closeButton.addEventListener('click', this._closeButtonClickHandler);\n    this._options.addEventListener('change', this._optionChangeHandler);\n    this._options.addEventListener('submit', this._optionSubmitHandler);\n\n    this._keyboard = keyboard;\n\n    // Если тип клавиатуры не определен, то начальные настройки\n    // соответствуют самому популярному варианту\n    this._initialKeyboardType = this._keyboard.type ?\n        this._keyboard.type : KEYBOARD_TYPE_WINDOWS_ANSI_RUS_PC;\n\n    this._isRequired = false;\n\n    this._setInitialOptionVariants();\n  }\n\n  open (isRequired) {\n    this._isRequired = Boolean(isRequired);\n\n    this._prepareDialogForOpening();\n\n    return new Promise((resolve => {\n      this._closeDialogPromiseResolver = resolve;\n    }));\n  }\n\n  get keyboardLayout () {\n    if (this._options[OS_OPTION] === OS_WINDOWS) {\n      return LAYOUTS_NAMES_TRANSLATIONS[LAYOUT_RUS_PC];\n    }\n\n    return LAYOUTS_NAMES_TRANSLATIONS.get(\n      this._options[LAYOUT_OPTION].value\n    );\n  }\n\n  _prepareDialogForOpening () {\n    this._element.classList.remove('keyboard-select-dialog_hidden');\n\n    document.addEventListener('keydown', this._keydownHandler);\n\n    if (this._isRequired) {\n      this._closeButton.classList.add('keyboard-select-dialog__close-button_hidden');\n      this._submitButton.disabled = false;\n    } else {\n      this._closeButton.classList.remove('keyboard-select-dialog__close-button_hidden');\n    }\n\n    this._getFirstFocusableElement().focus();\n  }\n\n  _close () {\n    if (this._isRequired) return;\n\n    this._prepareDialogForClosing();\n\n    this._closeDialogPromiseResolver();\n  };\n\n  _prepareDialogForClosing () {\n    this._element.classList.add('keyboard-select-dialog_hidden');\n\n    document.removeEventListener('keydown', this._keydownHandler);\n\n    this._setInitialOptionVariants();\n  }\n\n  _setInitialOptionVariants () {\n    const initialOptionVariants = KEYBOARD_TYPES_TO_OPTION_VARIANTS.get(this._initialKeyboardType);\n\n    this._options[OS_OPTION].value = initialOptionVariants.os;\n    this._options[ENTER_OPTION].value = initialOptionVariants.enter;\n    this._options[LAYOUT_OPTION].value = initialOptionVariants.layout ?\n        initialOptionVariants.layout : LAYOUT_RUS;\n\n    this._manageNeedToSelectLayout();\n    this._manageAbilityToSubmitOptions();\n  }\n\n  _calculateCurrentKeyboardType () {\n    const osOptionVariant = this._options[OS_OPTION].value;\n    const enterOptionVariant = this._options[ENTER_OPTION].value;\n    const layoutOptionVariant = this._options[LAYOUT_OPTION].value;\n\n    if (osOptionVariant === OS_WINDOWS) {\n      return enterOptionVariant === ENTER_ANSI ?\n          KEYBOARD_TYPE_WINDOWS_ANSI_RUS_PC :\n          KEYBOARD_TYPE_WINDOWS_ISO_RUS_PC;\n    }\n\n    if (enterOptionVariant === ENTER_ANSI) {\n      return layoutOptionVariant === LAYOUT_RUS ?\n          KEYBOARD_TYPE_MACOS_ANSI_RUS :\n          KEYBOARD_TYPE_MACOS_ANSI_RUS_PC;\n    } else {\n      return layoutOptionVariant === LAYOUT_RUS ?\n          KEYBOARD_TYPE_MACOS_ISO_RUS :\n          KEYBOARD_TYPE_MACOS_ISO_RUS_PC;\n    }\n  }\n\n  _submitOptions () {\n    this._initialKeyboardType = this._calculateCurrentKeyboardType();\n    this._keyboard.changeType(this._initialKeyboardType);\n\n    this._submitButton.disabled = true;\n\n    if (!this._isRequired) return;\n\n    // Обязательная форма закрывается только при сабмите\n    this._isRequired = false;\n    this._close();\n  }\n\n  _manageAbilityToSubmitOptions () {\n    if (this._isRequired) return;\n\n    this._submitButton.disabled = this._initialKeyboardType === this._calculateCurrentKeyboardType();\n  }\n\n  _manageNeedToSelectLayout () {\n    if (this._options[OS_OPTION].value === OS_MACOS) {\n      this._layoutOption.classList.remove('keyboard-select-dialog__option_hidden');\n    } else {\n      this._layoutOption.classList.add('keyboard-select-dialog__option_hidden');\n    }\n  }\n\n  _manageFocus (evt) {\n    const firstFocusableElement = this._getFirstFocusableElement();\n    const lastFocusableElement = this._getLastFocusableElement();\n\n    if (evt.shiftKey) {\n      if (document.activeElement === firstFocusableElement) {\n        evt.preventDefault();\n        lastFocusableElement.focus();\n      }\n    } else if (document.activeElement === lastFocusableElement) {\n      evt.preventDefault();\n      firstFocusableElement.focus();\n    }\n  }\n  \n  _getFirstFocusableElement () {\n    return this._closeButton.classList.contains('keyboard-select-dialog__close-button_hidden') ?\n      this._options.querySelector('.keyboard-select-dialog__option_os :checked') :\n      this._closeButton;\n  }\n\n  _getLastFocusableElement () {\n    if (!this._submitButton.disabled) {\n      return this._submitButton;\n    }\n\n    return this._layoutOption.classList.contains('keyboard-select-dialog__option_hidden') ?\n        this._options.querySelector('.keyboard-select-dialog__option_enter :checked') :\n        this._options.querySelector('.keyboard-select-dialog__option_layout :checked');\n  }\n\n  _optionChangeHandler = () => {\n    this._manageNeedToSelectLayout();\n    this._manageAbilityToSubmitOptions();\n  };\n\n  _optionSubmitHandler = (evt) => {\n    evt.preventDefault();\n\n    this._submitOptions();\n  };\n\n  _overlayClickHandler = () => {\n    this._close();\n  };\n\n  _closeButtonClickHandler = () => {\n    this._close();\n  };\n\n  _keydownHandler = (evt) => {\n    if (evt.key === 'Tab') {\n      this._manageFocus(evt);\n    }\n\n    if (evt.key === 'Escape') {\n      evt.preventDefault();\n\n      this._close();\n    }\n  };\n}\n","class Button {\n  constructor (element, clickHandler) {\n    this._element = element;\n    element.addEventListener(\"click\", clickHandler);\n  }\n\n  focus () {\n    this._element.focus();\n  }\n\n  get isFocused () {\n    return document.activeElement === this._element;\n  }\n}\n","class Toggle {\n  constructor (element) {\n    this._element = element;\n    this._element.addEventListener('click', this._clickHandler);\n  }\n  \n  toggle () {\n    if (this._element.getAttribute('aria-checked') === 'true') {\n      this._element.setAttribute('aria-checked', 'false');\n    } else {\n      this._element.setAttribute('aria-checked', 'true');\n    }\n  }\n\n  get element () {\n    return this._element;\n  }\n\n  get isChecked () {\n    return this._element.getAttribute('aria-checked') === 'true';\n  }\n\n  set disabled (isDisabled) {\n    this._element.disabled = isDisabled;\n  }\n\n  _clickHandler = () => {\n    this.toggle();\n  };\n}\n","const SERIES_MAX_LENGTH = 3;\n\nclass Statistics {\n  constructor(problemKeyCodes) {\n    this._problemKeyCodes = new Set(problemKeyCodes);\n\n    this._seriesCounters = new Map();\n    this._currentSeries = new Map();\n\n    this._typoCounters = new Map();\n  }\n\n  addWrongKeyCode(keyCode) {\n    let typoCounter = (this._typoCounters.has(keyCode)) ?\n      this._typoCounters.get(keyCode) : 0;\n\n    typoCounter++;\n\n    this._typoCounters.set(keyCode, typoCounter);\n\n    if (this._currentSeries.has(keyCode)) {\n      this._currentSeries.set(keyCode, 0);\n    }\n  }\n\n  addCorrectKeyCode(keyCode) {\n    if (!this._problemKeyCodes.has(keyCode)) return;\n\n    let currentSeries = (this._currentSeries.has(keyCode)) ?\n      this._currentSeries.get(keyCode) : 0;\n\n    currentSeries++;\n\n    if (currentSeries < SERIES_MAX_LENGTH) {\n      this._currentSeries.set(keyCode, currentSeries);\n      return;\n    }\n\n    this._currentSeries.set(keyCode, 0);\n\n    let seriesCounter = (this._seriesCounters.has(keyCode)) ?\n      this._seriesCounters.get(keyCode) : 0;\n\n    seriesCounter++;\n\n    this._seriesCounters.set(keyCode, seriesCounter);\n  }\n\n  get keyCodesToTypoAmounts () {\n    return this._typoCounters;\n  }\n\n  get keyCodesToCorrectSeriesAmounts () {\n    return this._seriesCounters;\n  }\n}\n"]}